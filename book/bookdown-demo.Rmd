--- 
title: "R bookdown 新手村"
author: "Chen, Ching-Chih"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
documentclass: book
bibliography: [book.bib, packages.bib, web.bib]
biblio-style: apalike
link-citations: yes
github-repo: rstudio/bookdown-demo
description: "This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook."
---
# 前言
## 學習bookdown的動機
給同時想要有個屬於自己的網頁與漂亮排版的你。  
bookdown兼具word寫作時的自然，與latex排版上的優美，但少了latex在排版上的繁瑣設定，此外bookdown的輸出格式也可自行設定，有word, pdf, html可做選擇。   
bookdown是透過markdown的方式進行電子書的寫作。  [R Markdown 介紹](https://bookdown.org/tpemartin/rmarkdown_intro/#markdown)  

## 預先安裝的套件
假設你已經裝好R與Rstudio  
1.安裝rmarkdown  
```{r eval=FALSE, include=TRUE}
# Install from CRAN
install.packages('rmarkdown')

# Or if you want to test the development version,
# install from GitHub
if (!requireNamespace("devtools"))
  install.packages('devtools')
devtools::install_github('rstudio/rmarkdown')
```
2.安裝輕量版latex, [tinytex](https://yihui.name/tinytex/)(給沒裝過latex的人使用)  
[Windows系统可能需要五分鐘左右（其間可能會彈出兩次錯誤訊息，點確認即可；如果防毒軟體彈出警告，請允許修改）。](https://yihui.org/tinytex/cn/)
```{r eval=FALSE}
install.packages("tinytex")
tinytex::install_tinytex()  # install TinyTeX
```

## 其他需要的帳號
[GitHub](https://github.com/) : 工程師的臉書  
[Google Analytics](https://analytics.google.com/analytics/web/) : 電子書線上流量分析



```{r include=FALSE}
# automatically create a bib database for R packages
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown'
), 'packages.bib')
```



<!--chapter:end:index.Rmd-->

# 建立自己的電子書
## 生成電子書範例  
1. 先從github
**bookdown** 套件可以從 `CRAN`上安裝:

```{r eval=FALSE}
install.packages("bookdown")
# or the development version
# devtools::install_github("rstudio/bookdown")
```

2.下載書的草稿[Github](https://github.com/rstudio/bookdown-demo)/[中文模板](https://github.com/yihui/bookdown-chinese)。   
3.打開`bookdown-demo`資料夾，點選`bookdown-demo.Rproj`。     
4.點開`index.Rmd` 再點選Rstudio右上角`Build`分頁裡面的 `Build Book`，便會看到書的草稿。  

## 注意事項  
不可更改`index.Rmd`{-}
因為後續生成的`index.html`是網頁讀取的首要項目!

<!--chapter:end:01-intro.Rmd-->

# 書本編輯 

跑出單一章節的方法:可以透過上方的`Knit`按鍵，或是用以下方法生成電子書(gitbook)
```{r 簡介1,eval=FALSE, include=TRUE}
bookdown::preview_chapter("01-intro.rmd", output_format="bookdown::gitbook")
```

## Markdown 語法(syntax)
詳見[林茂廷老師上課講義](https://bookdown.org/tpemartin/rmarkdown_intro/markdown-syntax.html#e59fbae69cace8aa9ee6b395)[@R_Markdown_介紹]、
[markdown_cheatsheet](https://github.com/rstudio/cheatsheets/raw/master/rmarkdown-2.0.pdf)、或是[bookdown電子書範例](https://bookdown.org/yihui/bookdown/markdown-syntax.html#inline-formatting)[@Authoring_Books]。  

注意換行要在結束句輸入「兩」個空格，才換行。不然就要按兩次`enter`鍵。  
一個空格只是單純的空格，「兩」個空格才會有新的意義，如換行或內縮（在列點時用）。  

## 書本的排序
最先讀取的檔案為`index.Rmd`(此為網頁讀取html檔的預設值)，再來以數字大小順序排列，範例中即以`01-intro.Rmd`,`02-literature.Rmd`...而以`_`開頭的檔案不會被編入電子書裡。  

## 參考文獻引注
建立`.bib`檔，範例程式中已有`book.bib`(圖書),`packages.bib`(R套件)，可以自行做增刪。  
在`index.Rmd`
```{r eval=FALSE}
--- 
title: "A Minimal Book Example"
author: "Yihui Xie"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
documentclass: book
# 設定參考文獻!
## 要讀取的檔案
bibliography: [book.bib, packages.bib]
biblio-style: apalike
#設定為 yes，才有超連結功能
link-citations: yes
github-repo: rstudio/bookdown-demo
description: "This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook."
---
```
`.bib`內的格式
```{r eval=FALSE}
@Manual{R-base, #名稱(key) 
  title = {R: A Language and Environment for Statistical
    Computing}, # 文獻類別 : article, book, manual
  author = {{R Core Team}}, #作者
  organization = {R Foundation for Statistical Computing}, #機構
  address = {Vienna, Austria},
  year = {2016}, #年分
  url = {https://www.R-project.org/}, #網址
}
```
這裡引用[@R-base](`[@R-base]`)`[@名稱(key)]`  
最後一個檔案(範例中為`06-references.Rmd`)，可僅用一行程式表達，
```{r eval=FALSE}
`r if (knitr::is_html_output()) '# References {-}'`
```



### 有趣的互動應用{-}
Shiny app example:
```{r include=TRUE}
knitr::include_app("https://yihui.shinyapps.io/miniUI/", 
  height = "600px")
```


<!--chapter:end:02-literature.Rmd-->

# 發布電子書至網路

## 發佈到GitHub上{-}  

### 告知GitHub此電子書並非Jekyll所生成
[建立](https://bookdown.org/yihui/bookdown/github.html)`.nojekyl`(會出現在與bookdown-demo .R porject的資料夾)，
```{r eval=FALSE, include=TRUE}
file.create('.nojekyll')
```
再將`_bookdown.yml`新增`output_dir: "docs"`，接著執行一次Build Book，匯出的內容就會在docs子資料夾中，再將剛剛產生的`.nojekyl`放到docs子資料夾中。

### GitHub設定
在`Setting` -> `Options` -> `GitHub Pages` -> `Source` 改成 "master branch /docs folder"。  
變更後在`Setting` -> `Options` -> `GitHub Pages`就會出現 Your site is ready to be published at "你的電子書網址"。


<!--chapter:end:03-method.Rmd-->

# 使用狀況追蹤

## 了解你的影響力{-}
透過[Goolge Analytics](https://analytics.google.com/analytics/web/)來追蹤書本的使用狀況，
先申請Goolge Analytics的追蹤碼，
再將[追蹤碼鑲嵌](https://benmarwick.github.io/bookdown-ort/mods.html?fbclid=IwAR00Y3A7JOY5eBsGk3IyCscTQhPNZXAIj3Et6o-zgSYXfU5Nns5Ag4L-Qc8)至電子書中。[@Minimal]  
在`_output.yml`加入`includes: in_header: [ google_analytics.html]`，
```{r eval=FALSE}
bookdown::gitbook:
  includes:
    in_header: [ google_analytics.html]
```
接著新開一個google_analytics.html，將Goolge Analytics的代碼放到google_analytics.html裡。
```{r eval=FALSE}
#從這裡以下開始複製你的追蹤碼到google_analytics.html裡  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-159991960-1"></script>
<script>
你的追蹤
</script>

```




<!--chapter:end:04-application.Rmd-->

# NTU thesis bookdown模板
[臺大論文模板](https://yongfu.name/ntuthesis/doc/)
[@NTU]
感謝開發者[廖永賦](https://github.com/liao961120/ntuthesis)的用心!  

[後續更新](https://github.com/liao961120/ntuthesis/issues/15)/
[commit過程紀錄](https://github.com/ChenChingChih/thesis/commits/master)/
[成品](https://chenchingchih.github.io/thesis/) 

## 安裝
最新版
```{r eval=FALSE}
#install.packages('remotes')
remotes::install_github("liao961120/ntuthesis")
```
套件所需的字體檔
```{r eval=FALSE}
#install.packages('remotes')
remotes::install_github("liao961120/ntuthesis")
```

## 匯入論文模板
打開`ntuthesis.Rproject`在 console 執行：
```{r eval=FALSE}
ntuthesis::import_template("project_name")
```
會出現`project_name`資料夾。  
在`project_name`資料夾中開一個`R-project`檔，然後開啟該`R-project`檔。

###  編輯封面
按照[原作者](https://yongfu.name/ntuthesis/doc/export-thesis.html)指令操作，會安裝.tex需要用到的套件到tinytex中。  

### Compile 論文
將`01-install-compile.rmd`內的28~34行刪除，
```{r eval=FALSE}
if (knitr::is_html_output()) {
  knitr::include_graphics("figs/rmd-template.gif")
} else {
  knitr::include_graphics("figs/rmd-template.png")
}

```

調整_output.yml 5~6行，
```{r eval=FALSE}
  includes:
#    in_header: latex/custom.js
#    after_body: disqus.html

```
再點選build book即可生成gitbook和pdf檔。
```{r eval=FALSE}
bookdown::render_book("index.Rmd", "bookdown::gitbook")
bookdown::render_book("index.Rmd", "bookdown::pdf_book")
```

## 發布至網路
請參考[.nojekyl][發布電子書至網路]  



<!--chapter:end:05-ntuthesis.Rmd-->

`r if (knitr:::is_html_output()) '
# References {-}
'`

<!--chapter:end:06-references.Rmd-->

# (APPENDIX) Appendix{-} 


<!--chapter:end:07-附錄.Rmd-->

